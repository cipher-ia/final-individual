{"mappings":"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","sources":["src/javascript/index.js"],"sourcesContent":["let baseUrl = \"http://localhost:8080/productos\";\nlet carrito = [];\n\n\nfunction mostrarMensaje(mensaje, tipo) {\n    $(\"#mensaje\")\n        .removeClass(\"d-none alert-success alert-danger alert-warning\")\n        .addClass(`alert alert-${tipo}`)\n        .html(mensaje);\n}\n\n\nfunction cargarProductos() {\n    $.ajax({\n        url: baseUrl,\n        method: \"GET\",\n        success: function (productos) {\n            $(\"#productoSeleccionado\").empty(); \n            productos.forEach(p => {\n                $(\"#productoSeleccionado\").append(\n                    `<option value=\"${p.id}\" data-nombre=\"${p.nombre}\" data-precio=\"${p.precio}\" data-stock=\"${p.cantidad}\">\n                        ${p.nombre} - €${p.precio} (Stock: ${p.cantidad})\n                    </option>`\n                );\n            });\n        },\n        error: function () {\n            mostrarMensaje(\"Error al cargar productos.\", \"danger\");\n        }\n    });\n}\n\n\n$(document).on(\"click\", \"#agregarCarrito\", function () {\n    let idProducto = $(\"#productoSeleccionado\").val();\n    let nombreProducto = $(\"#productoSeleccionado option:selected\").data(\"nombre\");\n    let cantidad = parseInt($(\"#cantidadProducto\").val());\n\n    if (!idProducto || cantidad <= 0) {\n        mostrarMensaje(\"Seleccione un producto y cantidad válida.\", \"warning\");\n        return;\n    }\n\n    \n    let existente = carrito.find(p => p.id == idProducto);\n    if (existente) {\n        existente.cantidad += cantidad;\n    } else {\n        carrito.push({ id: idProducto, nombre: nombreProducto, cantidad });\n    }\n\n    actualizarCarrito();\n    mostrarMensaje(\"Producto añadido al carrito.\", \"success\");\n});\n\n\nfunction actualizarCarrito() {\n    let contenedor = $(\"#carritoProductos\").empty();\n    carrito.forEach(producto => {\n        contenedor.append(`\n            <div class=\"col-md-4\" data-id=\"${producto.id}\">\n                <div class=\"card\">\n                    <div class=\"card-body\">\n                        <h5 class=\"card-title\">${producto.nombre}</h5>\n                        <p class=\"card-text\">Cantidad: ${producto.cantidad}</p>\n                        <button class=\"btn btn-danger btn-sm quitarProducto\">Quitar</button>\n                    </div>\n                </div>\n            </div>\n        `);\n    });\n}\n\n\n$(document).on(\"click\", \".quitarProducto\", function () {\n    let idProducto = $(this).closest(\".col-md-4\").data(\"id\");\n    carrito = carrito.filter(p => p.id != idProducto);\n    actualizarCarrito();\n    mostrarMensaje(\"Producto eliminado del carrito.\", \"warning\");\n});\n\n\n$(document).on(\"click\", \"#realizarCompra\", function () {\n    if (carrito.length === 0) {\n        mostrarMensaje(\"El carrito está vacío.\", \"warning\");\n        return;\n    }\n\n    let exitos = [];\n    let fallos = [];\n\n    (async function procesarCompras() {\n        for (let producto of carrito) {\n            try {\n                await $.ajax({\n                    url: `${baseUrl}/${producto.id}/compra`,\n                    method: \"POST\",\n                });\n                exitos.push(producto.nombre);\n            } catch (error) {\n                fallos.push(producto.nombre);\n            }\n        }\n\n        mostrarMensaje(`\n            <strong>Compra realizada:</strong><br>\n            Exitosos: ${exitos.join(\", \") || \"Ninguno\"}<br>\n            Fallidos: ${fallos.join(\", \") || \"Ninguno\"}\n        `, \"info\");\n\n        carrito = [];\n        actualizarCarrito();\n    })();\n});\n\n\n$(\"#recargar\").on(\"click\", function () {\n    $(\"#recargar ul\").empty(); \n    $(\"#productoSeleccionado option\").each(function () {\n        if ($(this).val()) { \n            $(\"#recargar ul\").append(`<li>${$(this).text()}</li>`);\n        }\n    });\n});\ncargarProductos();"],"names":[],"version":3,"file":"index.005eec76.js.map","sourceRoot":"/__parcel_source_root/"}